C     D1MACH - DOUBLE PRECISION MACHINE CONSTANTS FOR IBM 360/370
C     CONFIGURED FOR IBM SYSTEM/360 FORTRAN G
C
      DOUBLE PRECISION FUNCTION D1MACH (I)
C
C     MACHINE CONSTANTS FOR THE IBM 360/370 SERIES.
C
C     D1MACH(1) = B**(EMIN-1), THE SMALLEST POSITIVE MAGNITUDE.
C     D1MACH(2) = B**EMAX*(1 - B**(-T)), THE LARGEST MAGNITUDE.
C     D1MACH(3) = B**(-T), THE SMALLEST RELATIVE SPACING.
C     D1MACH(4) = B**(1-T), THE LARGEST RELATIVE SPACING.
C     D1MACH(5) = LOG10(B)
C
C     IBM 360/370: BASE 16, 14 HEX DIGITS, EXPONENT RANGE -64 TO 63
C     DOUBLE PRECISION IS 8 BYTES = 2 INTEGERS
C
C     USE INTEGER ARRAY WITH EQUIVALENCE TO SET BIT PATTERNS
C
      INTEGER IMACH(10)
      DOUBLE PRECISION DMACH(5)
      EQUIVALENCE (DMACH(1),IMACH(1))
C
C     IBM 360/370 HEXADECIMAL DOUBLE PRECISION VALUES
C     STORED AS INTEGER PAIRS, ACCESSED AS DOUBLE VIA EQUIVALENCE
C
C     IMACH(1),IMACH(2)  = Z'00100000',Z'00000000' = SMALLEST POSITIVE
C     IMACH(3),IMACH(4)  = Z'7FFFFFFF',Z'FFFFFFFF' = LARGEST
C     IMACH(5),IMACH(6)  = Z'33100000',Z'00000000' = SMALLEST REL SPACING
C     IMACH(7),IMACH(8)  = Z'34100000',Z'00000000' = LARGEST REL SPACING
C     IMACH(9),IMACH(10) = Z'41134413',Z'509F79FF' = LOG10(16)
C
      DATA IMACH( 1) /    1048576 /
      DATA IMACH( 2) /          0 /
      DATA IMACH( 3) / 2147483647 /
      DATA IMACH( 4) /         -1 /
      DATA IMACH( 5) /  856686592 /
      DATA IMACH( 6) /          0 /
      DATA IMACH( 7) /  873463808 /
      DATA IMACH( 8) /          0 /
      DATA IMACH( 9) / 1092895763 /
      DATA IMACH(10) / 1352628735 /
C
      IF (I .LT. 1 .OR. I .GT. 5) GO TO 10
      D1MACH = DMACH(I)
      RETURN
C
   10 CONTINUE
      WRITE(6,100) I
  100 FORMAT(' D1MACH - I OUT OF BOUNDS:',I10)
      D1MACH = 0.0D0
      RETURN
      END
