C     R1MACH - REAL MACHINE CONSTANTS FOR IBM 360/370
C     CONFIGURED FOR IBM SYSTEM/360 FORTRAN G
C
      REAL FUNCTION R1MACH (I)
C
C     MACHINE CONSTANTS FOR THE IBM 360/370 SERIES.
C
C     R1MACH(1) = B**(EMIN-1), THE SMALLEST POSITIVE MAGNITUDE.
C     R1MACH(2) = B**EMAX*(1 - B**(-T)), THE LARGEST MAGNITUDE.
C     R1MACH(3) = B**(-T), THE SMALLEST RELATIVE SPACING.
C     R1MACH(4) = B**(1-T), THE LARGEST RELATIVE SPACING.
C     R1MACH(5) = LOG10(B)
C
C     IBM 360/370: BASE 16, 6 HEX DIGITS, EXPONENT RANGE -64 TO 63
C
C     USE INTEGER ARRAY WITH EQUIVALENCE TO SET BIT PATTERNS
C
      INTEGER IMACH(5)
      REAL RMACH(5)
      EQUIVALENCE (RMACH(1),IMACH(1))
C
C     IBM 360/370 HEXADECIMAL FLOATING POINT VALUES
C     STORED AS INTEGERS, ACCESSED AS REALS VIA EQUIVALENCE
C
C     IMACH(1) = Z'00100000' = SMALLEST POSITIVE = 16**(-65)
C     IMACH(2) = Z'7FFFFFFF' = LARGEST = 16**63 * (1 - 16**(-6))
C     IMACH(3) = Z'3B100000' = SMALLEST REL SPACING = 16**(-6)
C     IMACH(4) = Z'3C100000' = LARGEST REL SPACING = 16**(-5)
C     IMACH(5) = Z'41134413' = LOG10(16) = 1.20412...
C
      DATA IMACH(1) / 1048576 /
      DATA IMACH(2) / 2147483647 /
      DATA IMACH(3) / 990904320 /
      DATA IMACH(4) / 1007681536 /
      DATA IMACH(5) / 1092895763 /
C
      IF (I .LT. 1 .OR. I .GT. 5) GO TO 10
      R1MACH = RMACH(I)
      RETURN
C
   10 CONTINUE
      WRITE(6,100) I
  100 FORMAT(' R1MACH - I OUT OF BOUNDS:',I10)
      R1MACH = 0.0
      RETURN
      END
C     I1MACH - INTEGER MACHINE CONSTANTS FOR IBM 360/370
C     CONFIGURED FOR IBM SYSTEM/360 FORTRAN G
C
      INTEGER FUNCTION I1MACH (I)
C
C     MACHINE CONSTANTS FOR THE IBM 360/370 SERIES,
C     THE XEROX SIGMA 5/7/9, THE SEL SYSTEMS 85/86, AND
C     THE PERKIN ELMER (INTERDATA) 7/32.
C
      INTEGER IMACH(16)
C
      DATA IMACH( 1) /          5 /
      DATA IMACH( 2) /          6 /
      DATA IMACH( 3) /          7 /
      DATA IMACH( 4) /          6 /
      DATA IMACH( 5) /         32 /
      DATA IMACH( 6) /          4 /
      DATA IMACH( 7) /          2 /
      DATA IMACH( 8) /         31 /
      DATA IMACH( 9) /  2147483647 /
      DATA IMACH(10) /         16 /
      DATA IMACH(11) /          6 /
      DATA IMACH(12) /        -64 /
      DATA IMACH(13) /         63 /
      DATA IMACH(14) /         14 /
      DATA IMACH(15) /        -64 /
      DATA IMACH(16) /         63 /
C
C     I1MACH( 1) = THE STANDARD INPUT UNIT.
C     I1MACH( 2) = THE STANDARD OUTPUT UNIT.
C     I1MACH( 3) = THE STANDARD PUNCH UNIT.
C     I1MACH( 4) = THE STANDARD ERROR MESSAGE UNIT.
C     I1MACH( 5) = THE NUMBER OF BITS PER INTEGER STORAGE UNIT.
C     I1MACH( 6) = THE NUMBER OF CHARACTERS PER INTEGER STORAGE UNIT.
C     I1MACH( 7) = A, THE BASE (RADIX) FOR INTEGERS.
C     I1MACH( 8) = S, THE NUMBER OF BASE-A DIGITS.
C     I1MACH( 9) = A**S - 1, THE LARGEST MAGNITUDE.
C     I1MACH(10) = B, THE BASE FOR FLOATING-POINT (16 FOR IBM HEX).
C     I1MACH(11) = T, THE NUMBER OF BASE-B DIGITS (SINGLE PRECISION).
C     I1MACH(12) = EMIN, THE SMALLEST EXPONENT (SINGLE PRECISION).
C     I1MACH(13) = EMAX, THE LARGEST EXPONENT (SINGLE PRECISION).
C     I1MACH(14) = T, THE NUMBER OF BASE-B DIGITS (DOUBLE PRECISION).
C     I1MACH(15) = EMIN, THE SMALLEST EXPONENT (DOUBLE PRECISION).
C     I1MACH(16) = EMAX, THE LARGEST EXPONENT (DOUBLE PRECISION).
C
      IF (I .LT. 1 .OR. I .GT. 16) GO TO 10
      I1MACH = IMACH(I)
      RETURN
C
   10 CONTINUE
      WRITE(6,100) I
  100 FORMAT(' I1MACH - I OUT OF BOUNDS:',I10)
      I1MACH = 0
      RETURN
      END
C     TEST_MACH - SIMPLE TEST OF I1MACH AND R1MACH
C
      INTEGER I1MACH, IOUT
      REAL R1MACH, ROUT
C
      WRITE(6,100)
  100 FORMAT(' TESTING MACHINE CONSTANTS')
C
C     TEST I1MACH
      WRITE(6,110)
  110 FORMAT(' TESTING I1MACH:')
      IOUT = I1MACH(1)
      WRITE(6,120) IOUT
  120 FORMAT('   I1MACH(1) = ',I10)
      IOUT = I1MACH(2)
      WRITE(6,130) IOUT
  130 FORMAT('   I1MACH(2) = ',I10)
C
C     TEST R1MACH
      WRITE(6,200)
  200 FORMAT(' TESTING R1MACH:')
      ROUT = R1MACH(1)
      WRITE(6,210) ROUT
  210 FORMAT('   R1MACH(1) = ',E15.7)
      ROUT = R1MACH(2)
      WRITE(6,220) ROUT
  220 FORMAT('   R1MACH(2) = ',E15.7)
C
      WRITE(6,300)
  300 FORMAT(' TEST COMPLETE')
      STOP
      END
