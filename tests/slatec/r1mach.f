C     R1MACH - REAL MACHINE CONSTANTS FOR IBM 360/370
C     CONFIGURED FOR IBM SYSTEM/360 FORTRAN G
C
      REAL FUNCTION R1MACH (I)
C
C     MACHINE CONSTANTS FOR THE IBM 360/370 SERIES.
C
C     R1MACH(1) = B**(EMIN-1), THE SMALLEST POSITIVE MAGNITUDE.
C     R1MACH(2) = B**EMAX*(1 - B**(-T)), THE LARGEST MAGNITUDE.
C     R1MACH(3) = B**(-T), THE SMALLEST RELATIVE SPACING.
C     R1MACH(4) = B**(1-T), THE LARGEST RELATIVE SPACING.
C     R1MACH(5) = LOG10(B)
C
C     IBM 360/370: BASE 16, 6 HEX DIGITS, EXPONENT RANGE -64 TO 63
C
C     USE INTEGER ARRAY WITH EQUIVALENCE TO SET BIT PATTERNS
C
      INTEGER IMACH(5)
      REAL RMACH(5)
      EQUIVALENCE (RMACH(1),IMACH(1))
C
C     IBM 360/370 HEXADECIMAL FLOATING POINT VALUES
C     STORED AS INTEGERS, ACCESSED AS REALS VIA EQUIVALENCE
C
C     IMACH(1) = Z'00100000' = SMALLEST POSITIVE = 16**(-65)
C     IMACH(2) = Z'7FFFFFFF' = LARGEST = 16**63 * (1 - 16**(-6))
C     IMACH(3) = Z'3B100000' = SMALLEST REL SPACING = 16**(-6)
C     IMACH(4) = Z'3C100000' = LARGEST REL SPACING = 16**(-5)
C     IMACH(5) = Z'41134413' = LOG10(16) = 1.20412...
C
      DATA IMACH(1) / 1048576 /
      DATA IMACH(2) / 2147483647 /
      DATA IMACH(3) / 990904320 /
      DATA IMACH(4) / 1007681536 /
      DATA IMACH(5) / 1092895763 /
C
      IF (I .LT. 1 .OR. I .GT. 5) GO TO 10
      R1MACH = RMACH(I)
      RETURN
C
   10 CONTINUE
      WRITE(6,100) I
  100 FORMAT(' R1MACH - I OUT OF BOUNDS:',I10)
      R1MACH = 0.0
      RETURN
      END
