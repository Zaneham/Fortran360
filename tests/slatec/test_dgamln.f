C     TEST_DGAMLN - TEST THE SLATEC DGAMLN (DOUBLE PREC LOG GAMMA)
C     ON IBM SYSTEM/360 FORTRAN G
C
C     DGAMLN(N) FOR INTEGER N = LN((N-1)!)
C
      DOUBLE PRECISION DGAMLN, D1MACH
      DOUBLE PRECISION Z, RESULT, EXPECT, ERR, D1, D2
      INTEGER I, IERR, I1MACH, I1, I2
C
      WRITE(6,100)
  100 FORMAT(' SLATEC DGAMLN (DOUBLE PREC LOG GAMMA) TEST')
      WRITE(6,110)
  110 FORMAT(' ============================================')
      WRITE(6,120)
  120 FORMAT(' ')
C
C     TEST MACHINE CONSTANTS FIRST
      WRITE(6,130)
  130 FORMAT(' DOUBLE PRECISION MACHINE CONSTANTS:')
      I1 = I1MACH(14)
      WRITE(6,140) I1
  140 FORMAT('   I1MACH(14) DP DIGITS=',I3)
      D1 = D1MACH(1)
      WRITE(6,150) D1
  150 FORMAT('   D1MACH(1) SMALLEST=',D15.7)
      D2 = D1MACH(2)
      WRITE(6,160) D2
  160 FORMAT('   D1MACH(2) LARGEST=',D15.7)
      D1 = D1MACH(4)
      WRITE(6,170) D1
  170 FORMAT('   D1MACH(4) EPSILON=',D15.7)
      WRITE(6,120)
C
C     TEST INTEGER ARGUMENTS (TABLE LOOKUP)
      WRITE(6,200)
  200 FORMAT(' INTEGER ARGUMENT TESTS:')
C
C     DGAMLN(1) = 0
      Z = 1.0D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 0.0D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
  210 FORMAT('   DGAMLN(',F5.1,')=',D18.10,/,
     1       '            EXPECT=',D18.10,' ERR=',D10.2,' IERR=',I2)
C
C     DGAMLN(3) = LN(2)
      Z = 3.0D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 0.6931471805599453D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     DGAMLN(5) = LN(24)
      Z = 5.0D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 3.1780538303479458D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     DGAMLN(10) = LN(9!)
      Z = 10.0D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 12.801827480081469D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
      WRITE(6,120)
C
C     TEST NON-INTEGER ARGUMENTS (ASYMPTOTIC EXPANSION)
      WRITE(6,300)
  300 FORMAT(' NON-INTEGER ARGUMENT TESTS:')
C
C     DGAMLN(0.5) = LN(SQRT(PI))
      Z = 0.5D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 0.5723649429247001D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     DGAMLN(1.5) = LN(SQRT(PI)/2)
      Z = 1.5D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = -0.1207822376352452D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     DGAMLN(100.0) = VERY LARGE VALUE
      Z = 100.0D0
      RESULT = DGAMLN(Z, IERR)
      EXPECT = 359.1342053695754D0
      ERR = DABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
      WRITE(6,120)
C
C     TEST ERROR CONDITION
      WRITE(6,400)
  400 FORMAT(' ERROR CONDITION TEST:')
      Z = -1.0D0
      RESULT = DGAMLN(Z, IERR)
      WRITE(6,410) Z, IERR
  410 FORMAT('   DGAMLN(',F5.1,') IERR=',I2,' (SHOULD BE 1)')
C
      WRITE(6,120)
      WRITE(6,500)
  500 FORMAT(' SLATEC DGAMLN TEST COMPLETE')
      STOP
      END
