C     TEST_GAMLN - TEST THE SLATEC GAMLN (LOG GAMMA) FUNCTION
C     ON IBM SYSTEM/360 FORTRAN G
C
C     GAMLN(N) FOR INTEGER N = LN((N-1)!)
C     GAMLN(1) = LN(0!) = LN(1) = 0
C     GAMLN(2) = LN(1!) = LN(1) = 0
C     GAMLN(3) = LN(2!) = LN(2) = 0.693147...
C     GAMLN(4) = LN(3!) = LN(6) = 1.791759...
C     GAMLN(5) = LN(4!) = LN(24) = 3.178054...
C     GAMLN(6) = LN(5!) = LN(120) = 4.787492...
C
C     GAMLN(0.5) = LN(SQRT(PI)) = 0.572365...
C
      REAL GAMLN, R1MACH
      REAL Z, RESULT, EXPECT, ERR, R1, R2
      INTEGER I, IERR, I1MACH, I1, I2
C
      WRITE(6,100)
  100 FORMAT(' SLATEC GAMLN (LOG GAMMA) TEST')
      WRITE(6,110)
  110 FORMAT(' ================================')
      WRITE(6,120)
  120 FORMAT(' ')
C
C     TEST MACHINE CONSTANTS FIRST
      WRITE(6,130)
  130 FORMAT(' MACHINE CONSTANTS CHECK:')
      I1 = I1MACH(1)
      I2 = I1MACH(2)
      WRITE(6,140) I1, I2
  140 FORMAT('   STDIN=',I3,' STDOUT=',I3)
      I1 = I1MACH(10)
      I2 = I1MACH(11)
      WRITE(6,150) I1, I2
  150 FORMAT('   FP BASE=',I3,' DIGITS=',I3)
      R1 = R1MACH(1)
      WRITE(6,160) R1
  160 FORMAT('   R1MACH(1) SMALLEST=',E12.4)
      R2 = R1MACH(2)
      WRITE(6,170) R2
  170 FORMAT('   R1MACH(2) LARGEST=',E12.4)
      WRITE(6,120)
C
C     TEST INTEGER ARGUMENTS (TABLE LOOKUP)
      WRITE(6,200)
  200 FORMAT(' INTEGER ARGUMENT TESTS:')
C
C     GAMLN(1) = 0
      Z = 1.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 0.0
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
  210 FORMAT('   GAMLN(',F5.1,')=',F12.6,' EXPECT=',F12.6,
     1       ' ERR=',E10.2,' IERR=',I2)
C
C     GAMLN(2) = 0
      Z = 2.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 0.0
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(3) = LN(2)
      Z = 3.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 0.6931472
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(4) = LN(6)
      Z = 4.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 1.7917595
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(5) = LN(24)
      Z = 5.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 3.1780538
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(6) = LN(120)
      Z = 6.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 4.7874917
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(10) = LN(9!)
      Z = 10.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 12.8018275
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
      WRITE(6,120)
C
C     TEST NON-INTEGER ARGUMENTS (ASYMPTOTIC EXPANSION)
      WRITE(6,300)
  300 FORMAT(' NON-INTEGER ARGUMENT TESTS:')
C
C     GAMLN(0.5) = LN(SQRT(PI)) = 0.5723649...
      Z = 0.5
      RESULT = GAMLN(Z, IERR)
      EXPECT = 0.5723649
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(1.5) = LN(SQRT(PI)/2) = -0.1207822...
      Z = 1.5
      RESULT = GAMLN(Z, IERR)
      EXPECT = -0.1207822
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(2.5) = LN(3*SQRT(PI)/4) = 0.2846829...
      Z = 2.5
      RESULT = GAMLN(Z, IERR)
      EXPECT = 0.2846829
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(50.0) = LARGE VALUE
      Z = 50.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 144.5657439
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
C     GAMLN(100.0) = VERY LARGE VALUE
      Z = 100.0
      RESULT = GAMLN(Z, IERR)
      EXPECT = 359.1342054
      ERR = ABS(RESULT - EXPECT)
      WRITE(6,210) Z, RESULT, EXPECT, ERR, IERR
C
      WRITE(6,120)
C
C     TEST ERROR CONDITION
      WRITE(6,400)
  400 FORMAT(' ERROR CONDITION TEST:')
      Z = -1.0
      RESULT = GAMLN(Z, IERR)
      WRITE(6,410) Z, IERR
  410 FORMAT('   GAMLN(',F5.1,') IERR=',I2,' (SHOULD BE 1)')
C
      WRITE(6,120)
      WRITE(6,500)
  500 FORMAT(' SLATEC GAMLN TEST COMPLETE')
      STOP
      END
